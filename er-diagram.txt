erDiagram
    USER {
        int id PK
        string username
        string first_name
        string last_name
        string email
        string password
        int avatar_id FK
        datetime created_at
        datetime updated_at
    }

    FILE {
        int id PK
        string file_name
        string mime_type
        string key
        string url
        datetime created_at
        datetime updated_at
    }

    COUNTRY {
        int id PK
        string name
        datetime created_at
        datetime updated_at
    }

    GENRE {
        int id PK
        string name
        datetime created_at
        datetime updated_at
    }

    PERSON {
        int id PK
        string first_name
        string last_name
        text biography
        date date_of_birth
        %% ENUM('male', 'female', 'other')
        enum gender 
        int country_id FK
        int main_photo_id FK
        datetime created_at
        datetime updated_at
    }

    PERSON_PHOTO {
        int id PK
        int person_id FK
        int file_id FK
        datetime created_at
        datetime updated_at
    }

    MOVIE {
        int id PK
        string title
        text description
        decimal budget
        date release_date
        int duration
        int director_id FK
        int country_id FK
        int poster_id FK
        datetime created_at
        datetime updated_at
    }

    MOVIE_GENRE {
        int movie_id FK, PK
        int genre_id FK, PK
        datetime created_at
        datetime updated_at
    }

    CHARACTER {
        int id PK
        string name
        text description
        %% ENUM('leading', 'supporting', 'background')
        enum role
        datetime created_at
        datetime updated_at
    }

    MOVIE_PERSON_CHARACTER {
        int id PK
        int movie_id FK
        int person_id FK
        int character_id FK
        datetime created_at
        datetime updated_at
    }

    FAVORITE_MOVIE {
        int user_id FK, PK
        int movie_id FK, PK
        datetime created_at
        datetime updated_at
    }

    USER ||--o| FILE: "has avatar"
    USER ||--o{ FAVORITE_MOVIE : "has"
    MOVIE ||--o| FILE: "has poster" 
    MOVIE ||--o{ MOVIE_GENRE: "has"
    MOVIE ||--o{ MOVIE_PERSON_CHARACTER : "involves"
    COUNTRY ||--o{ MOVIE : "is origin of"
    COUNTRY ||--o{ PERSON: "is origin of"
    GENRE ||--o{ MOVIE_GENRE: "belongs to"
    FILE ||--o{ PERSON_PHOTO : "has"
    FILE ||--o| PERSON : "is main photo for"
    PERSON ||--o{ PERSON_PHOTO : "has"
    PERSON ||--o{ MOVIE: "directed"
    PERSON |o--o{ MOVIE_PERSON_CHARACTER : "participates in"
    CHARACTER |o--o{ MOVIE_PERSON_CHARACTER : "played by"
    FAVORITE_MOVIE }o--|| MOVIE : "refers to"